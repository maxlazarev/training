<div id="HiGHContextHandle" data-dyn-bind="visible: $control.Visible, sizing: $dyn.layout.sizing($control)">
    <button class="HiGHContextHandleMain" 
            draggable="true" 
            data-dyn-bind=" id: 'Button_' + $dyn.value($data.DataValue),
                            attr: {  'data-highcontexthandle-datavalue':     $data.DataValue, 
                                     'data-highcontexthandle-datasourcename':$data.DataSourceName, 
                                     'data-highcontexthandle-displayvalue':  $data.DisplayValue, 
                                     'data-high-objecttype':                 'HiGHContextHandle'},
                            event:  {contextmenu: $control.contextHandleContextMenu}"
            ondragstart="dragStart(event)" 
            ondragover="allowDrop(event)" 
            ondrop="drop(event)">&#9776;</button>    

    <!--Context menu -->
    <div class="hideContextHandleMenu" data-dyn-bind="foreach: $control.ContextMenuItems, id: $data.DataValue">
        <div>
            <!-- 10 (MenuItem) -->
            <div class="popupMenuItem" data-dyn-bind="style: {display: ($data.ItemType == 10 ? 'normal' : 'none')}">
                <button class="contextMenuButton button flyout-menuItem" data-dyn-bind=" title:  $data.Label,
                                    id:     $data.Id,
                                    event: {click: $control.onMenuItemClick}">
                    <div class="button-container">
                        <span class="button-commandRing imageBinder-emptyImage"></span>
                        <span class="button-label" data-dyn-bind="text: $data.Label"></span>
                    </div>
                </button>
            </div>
            <!-- 20 (Field) -->
            <div class="popupField" data-dyn-bind="style: {display: ($data.ItemType == 20 ? 'normal' : 'none')}">
                <div class="button-container">
                    <span class="button-commandRing imageBinder-emptyImage"></span>
                    <span data-dyn-bind="id: $data.Id, text: $data.Label,
                          event:  {click: ($data.IsLink ? $control.onMenuItemClick : null)},
                          css:    {'button-label': true, popupFieldLinked: $data.IsLink, popupFieldNotLinked: !$data.IsLinked, popupDisabled: !$data.Enabled}"></span>
                </div>
            </div>
            <!-- 30 (FieldValue) -->
            <div data-dyn-bind="style: {display: ($data.ItemType == 30 ? 'normal' : 'none')}">
                <div class="button-container">
                    <span class="button-commandRing imageBinder-emptyImage"></span>
                    <span class="button-label" data-dyn-bind="text: $data.Label, css: {popupDisabled: !$data.Enabled}"></span>
                    <span style="">&#58;</span>
                    <span data-dyn-bind="text:  $data.Value,
                                    id:     $data.Id,
                                    event:  {click: ($data.IsLink ? $control.onMenuItemClick : null)},
                                    css:    {'button-label': true, popupValueLinked: $data.IsLink, popupValueNotLinked: !$data.IsLinked, popupDisabled: !$data.Enabled}"></span>
                </div>
            </div>
            <!-- 40 (Header) -->
            <div class="popupHeader" data-dyn-bind="style: {display: ($data.ItemType == 40 ? 'normal' : 'none')}, text: $data.Label">
            </div>
            <!-- 50 (Icon) -->
            <div class="popupIcon" data-dyn-bind="style: {display: ($data.ItemType == 50 ? 'normal' : 'none')}">
                <img data-dyn-bind="attr: {src: $data.Value, title: $data.Label},
                                    event:  {click: ($data.IsLink ? $control.onMenuItemClick : null)},
                                    css:  {popupIcon: true, popupIconLinked: $data.IsLink}" />
            </div>
            <!-- 60 (Separator) -->
            <div class="popupSeparator" data-dyn-bind="style: {display: ($data.ItemType == 60 ? 'normal' : 'none')}">
                <hr style="background:#cccccc; border:0; height:1px" />
            </div>
        </div>
    </div>
</div>
<script src="/resources/scripts/HiGHContextHandle.js"></script>
<link href="/resources/styles/HiGHContextHandle.css" rel="stylesheet" type="text/css" />